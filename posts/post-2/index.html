<!DOCTYPE html>
<html><head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Advent Of Cyber | Day-2- Santa&#39;s Naughty &amp; Nice Log - Log File Analysis - gokupwn | Blog</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Use the ls command to list the files present in the current directory. How many log files are present? ssh elfmcblue@&lt;ip_address&gt; -p tryhackme! Explanation
elfmcblue@day-2-log-analysis:~$ ls *.log | wc -l 2 Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file? webserver.log
On what day was Santa&rsquo;s naughty and nice list stolen? Based on the result, we can conclude that the attacker led brute force directory against the site to gather available directories." />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Advent Of Cyber | Day-2- Santa&#39;s Naughty &amp; Nice Log - Log File Analysis" />
<meta property="og:description" content="Use the ls command to list the files present in the current directory. How many log files are present? ssh elfmcblue@&lt;ip_address&gt; -p tryhackme! Explanation
elfmcblue@day-2-log-analysis:~$ ls *.log | wc -l 2 Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file? webserver.log
On what day was Santa&rsquo;s naughty and nice list stolen? Based on the result, we can conclude that the attacker led brute force directory against the site to gather available directories." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://gokupwn.github.io/posts/post-2/" /><meta property="article:section" content="posts" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Advent Of Cyber | Day-2- Santa&#39;s Naughty &amp; Nice Log - Log File Analysis"/>
<meta name="twitter:description" content="Use the ls command to list the files present in the current directory. How many log files are present? ssh elfmcblue@&lt;ip_address&gt; -p tryhackme! Explanation
elfmcblue@day-2-log-analysis:~$ ls *.log | wc -l 2 Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file? webserver.log
On what day was Santa&rsquo;s naughty and nice list stolen? Based on the result, we can conclude that the attacker led brute force directory against the site to gather available directories."/>
<script src="https://gokupwn.github.io/js/feather.min.js"></script>
	
	
        <link href="https://gokupwn.github.io/css/fonts.11a1877508139eac0b5b4852ceb110c35641b3533321e66e39149e901ed5756b.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://gokupwn.github.io/css/main.dcdce5d0c876e01eff6576e36e0eaf7dac6d2941cbe7cd1770b52e1288fd3212.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://gokupwn.github.io/css/dark.19b9457bc32f3649f4646b44ab3d6445ba73f43a15cd0763d01e18bc77eb5bbf.css"  disabled />
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://gokupwn.github.io/">gokupwn | Blog</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/about">About</a>
		
		<a href="/tags">Tags</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="https://gokupwn.github.io/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Advent Of Cyber | Day-2- Santa&#39;s Naughty &amp; Nice Log - Log File Analysis</h1>
			<div class="meta">Posted on Jan 1, 0001</div>
		</div>
		

		<section class="body">
			<h3 id="use-thelscommand-to-list-the-files-present-in-the-current-directory-how-many-log-files-are-present">Use the <code>ls</code> command to list the files present in the current directory. How many log files are present?</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh elfmcblue@&lt;ip_address&gt; -p tryhackme!
</span></span></code></pre></div><p><a href="https://explainshell.com/explain?cmd=ls+*.log+%7C+wc+-l#">Explanation</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>elfmcblue@day-2-log-analysis:~$ ls *.log | wc -l
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>
</span></span></code></pre></div><h3 id="elf-mcskidy-managed-to-capture-the-logs-generated-by-the-web-server-what-is-the-name-of-this-log-file">Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?</h3>
<p>webserver.log</p>
<h3 id="on-what-day-was-santas-naughty-and-nice-list-stolen">On what day was Santa&rsquo;s naughty and nice list stolen?</h3>
<ul>
<li>Based on the result, we can conclude that the attacker led brute force directory against the site to gather available directories.</li>
<li><code>(&quot;gobuster/3.0.1&quot;)</code> <a href="https://github.com/OJ/gobuster.git">gobuster</a> is a directory/file, DNS and VHost busting tool written in Go.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>elfmcblue@day-2-log-analysis:~$ grep <span style="color:#e6db74">&#34;santa&#34;</span> webserver.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:28:16 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /santa HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:28:17 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /santa_claus HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:28:17 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /evilsanta HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:28:18 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /santana HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:28:18 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /santabarbara HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:34:39 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /santaslist.txt HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> <span style="color:#ae81ff">133872</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;Wget/1.19.4 (linux-gnu)&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:35:18 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /santafe HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:35:18 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /jasonsantamar-20 HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:35:18 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /santa_maria_maggiore HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:35:18 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /santa-clara-county HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:35:20 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /texas-santa-barbara HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:35:21 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /topicsantafe HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:35:22 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /jasonsantamaria HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span><span style="display:flex;"><span>10.10.249.191 - - <span style="color:#f92672">[</span>18/Nov/2022:12:35:27 +0000<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET /carlossantana_75 HTTP/1.1&#34;</span> <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#e6db74">&#34;gobuster/3.0.1&#34;</span>
</span></span></code></pre></div><ul>
<li>Yeah i am crazy :P:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>elfmcblue@day-2-log-analysis:~$ date -d <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>grep <span style="color:#e6db74">&#34;santaslist.txt&#34;</span> webserver.log | cut -d<span style="color:#e6db74">&#39; &#39;</span> -f4 | sed <span style="color:#e6db74">&#39;s/\[//g&#39;</span> | cut -d<span style="color:#e6db74">&#39;/&#39;</span> -f1,2 | sed <span style="color:#e6db74">&#39;s/\// /g&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>  +%A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Friday
</span></span></code></pre></div><h3 id="what-is-the-ip-address-of-the-attacker">What is the IP address of the attacker?</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>elfmcblue@day-2-log-analysis:~$ grep <span style="color:#e6db74">&#34;santaslist.txt&#34;</span> webserver.log | cut -d<span style="color:#e6db74">&#39; &#39;</span> -f1
</span></span><span style="display:flex;"><span>10.10.249.191
</span></span></code></pre></div><h3 id="what-is-the-name-of-the-important-list-that-the-attacker-stole-from-santa">What is the name of the important list that the attacker stole from Santa?</h3>
<ul>
<li>By filtering the data using the GREP and cut commands, we can examine the user agent for each saved query. The log entry with the <code>Wget/1.19.4 (Linux-gnu)</code> as a user agent caught my attention, mostly because its status code 200 indicates a successful http request.</li>
<li>According to this analysis, the filename is: <code>santaslist.txt</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>elfmcblue@day-2-log-analysis:~$ echo <span style="color:#e6db74">&#34;Request_type url_path http_status_code user_agent&#34;</span> <span style="color:#f92672">&amp;&amp;</span> grep <span style="color:#e6db74">&#34;santa&#34;</span> webserver.log | cut -d<span style="color:#e6db74">&#39;&#34;&#39;</span> -f2,3,6 | sed <span style="color:#e6db74">&#39;s/&#34;//g&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Request_type url_path http_status_code user_agent
</span></span><span style="display:flex;"><span>GET /santa HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /santa_claus HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /evilsanta HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /santana HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /santabarbara HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /santaslist.txt HTTP/1.1 <span style="color:#ae81ff">200</span> <span style="color:#ae81ff">133872</span> Wget/1.19.4 <span style="color:#f92672">(</span>linux-gnu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>GET /santafe HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /jasonsantamar-20 HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /santa_maria_maggiore HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /santa-clara-county HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /texas-santa-barbara HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /topicsantafe HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /jasonsantamaria HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span><span style="display:flex;"><span>GET /carlossantana_75 HTTP/1.1 <span style="color:#ae81ff">404</span> <span style="color:#ae81ff">437</span> gobuster/3.0.1
</span></span></code></pre></div><h3 id="look-through-the-log-files-for-the-flag-the-format-of-the-flag-is-thm">Look through the log files for the flag. The format of the flag is: THM</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>elfmcblue@day-2-log-analysis:~$ grep <span style="color:#e6db74">&#34;^THM{&#34;</span>  SSHD.log webserver.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>SSHD.log:THM<span style="color:#f92672">{</span>STOLENSANTASLIST<span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="ending">Ending:</h3>
<p>I hope you enjoyed this walkthrough and you learned something new ;).</p>

		</section>

		<div class="post-tags">
			
			
			
		</div>
	</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/gokupwn" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://twitter.com/gokupwn" rel="me" title="Twitter"><i data-feather="twitter"></i></a>
    <a class="border"></a><a class="soc" href="https://www.instagram.com/gokupwn/" rel="me" title="Instagram"><i data-feather="instagram"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2022  © gokupwn |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


<script>
  feather.replace()
</script></div>
    </body>
</html>
