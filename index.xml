<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>My Blog@gokupwn</title><link>https://gokupwn.github.io/</link><description>Recent content on My Blog@gokupwn</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Sat, 23 Nov 2024 21:41:45 +0100</lastBuildDate><atom:link href="https://gokupwn.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>About</title><link>https://gokupwn.github.io/posts/about/</link><pubDate>Sat, 23 Nov 2024 21:41:45 +0100</pubDate><guid>https://gokupwn.github.io/posts/about/</guid><description>&lt;ul>
&lt;li>Red Teamer&lt;/li>
&lt;li>CyberSecurity Researcher&lt;/li>
&lt;li>Offensive Cyber Security Engineer, Passionate about the inner workings of computers ;)&lt;/li>
&lt;li>Focused on web security, network security, reverse engineering, and malware analysis&lt;/li>
&lt;li>Attracted by state-sponsored threat actors ðŸ˜‰&lt;/li>
&lt;li>Former Instructor and penetration tester at Semicolon Academy&lt;/li>
&lt;li>Former Red Teamer at CovÃ©a&lt;/li>
&lt;li>IngÃ©nieur Civil des Mines (ICM) - Ã‰cole des Mines de Saint-Ã‰tienne&lt;/li>
&lt;li>Electrical and Telecommunications Engineer - Lebanese University&lt;/li>
&lt;/ul></description></item><item><title>Intro</title><link>https://gokupwn.github.io/posts/intro/</link><pubDate>Sat, 23 Nov 2024 20:36:45 +0100</pubDate><guid>https://gokupwn.github.io/posts/intro/</guid><description>&lt;p>This is a test&lt;/p></description></item><item><title>Advent Of Cyber | Day-2- Santa's Naughty &amp; Nice Log - Log File Analysis</title><link>https://gokupwn.github.io/posts/day-2-thm-adventofcyber/</link><pubDate>Sun, 04 Dec 2022 23:25:34 +0100</pubDate><guid>https://gokupwn.github.io/posts/day-2-thm-adventofcyber/</guid><description>&lt;h3 id="use-thelscommand-to-list-the-files-present-in-the-current-directory-how-many-log-files-are-present">Use theÂ &lt;code>ls&lt;/code>Â command to list the files present in the current directory. How many log files are present?&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>ssh elfmcblue@&amp;lt;ip_address&amp;gt; -p tryhackme!
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;a href="https://explainshell.com/explain?cmd=ls+*.log+%7C+wc+-l#">Explanation&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>elfmcblue@day-2-log-analysis:~$ ls *.log | wc -l
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="elf-mcskidy-managed-to-capture-the-logs-generated-by-the-web-server-what-is-the-name-of-this-log-file">Elf McSkidy managed to capture the logs generated by the web server. What is the name of this log file?&lt;/h3>
&lt;p>webserver.log&lt;/p>
&lt;h3 id="on-what-day-was-santas-naughty-and-nice-list-stolen">On what day was Santa&amp;rsquo;s naughty and nice list stolen?&lt;/h3>
&lt;ul>
&lt;li>Based on the result, we can conclude that the attacker led brute force directory against the site to gather available directories.&lt;/li>
&lt;li>&lt;code>(&amp;quot;gobuster/3.0.1&amp;quot;)&lt;/code> &lt;a href="https://github.com/OJ/gobuster.git">gobuster&lt;/a> is a directory/file, DNS and VHost busting tool written in Go.&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>elfmcblue@day-2-log-analysis:~$ grep &lt;span style="color:#e6db74">&amp;#34;santa&amp;#34;&lt;/span> webserver.log
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:28:16 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /santa HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:28:17 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /santa_claus HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:28:17 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /evilsanta HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:28:18 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /santana HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:28:18 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /santabarbara HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:34:39 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /santaslist.txt HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#ae81ff">133872&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Wget/1.19.4 (linux-gnu)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:35:18 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /santafe HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:35:18 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /jasonsantamar-20 HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:35:18 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /santa_maria_maggiore HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:35:18 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /santa-clara-county HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:35:20 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /texas-santa-barbara HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:35:21 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /topicsantafe HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:35:22 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /jasonsantamaria HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191 - - &lt;span style="color:#f92672">[&lt;/span>18/Nov/2022:12:35:27 +0000&lt;span style="color:#f92672">]&lt;/span> &lt;span style="color:#e6db74">&amp;#34;GET /carlossantana_75 HTTP/1.1&amp;#34;&lt;/span> &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> &lt;span style="color:#e6db74">&amp;#34;-&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gobuster/3.0.1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Yeah i am crazy :P:&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>elfmcblue@day-2-log-analysis:~$ date -d &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#66d9ef">$(&lt;/span>grep &lt;span style="color:#e6db74">&amp;#34;santaslist.txt&amp;#34;&lt;/span> webserver.log | cut -d&lt;span style="color:#e6db74">&amp;#39; &amp;#39;&lt;/span> -f4 | sed &lt;span style="color:#e6db74">&amp;#39;s/\[//g&amp;#39;&lt;/span> | cut -d&lt;span style="color:#e6db74">&amp;#39;/&amp;#39;&lt;/span> -f1,2 | sed &lt;span style="color:#e6db74">&amp;#39;s/\// /g&amp;#39;&lt;/span>&lt;span style="color:#66d9ef">)&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> +%A
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Friday
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="what-is-the-ip-address-of-the-attacker">What is the IP address of the attacker?&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>elfmcblue@day-2-log-analysis:~$ grep &lt;span style="color:#e6db74">&amp;#34;santaslist.txt&amp;#34;&lt;/span> webserver.log | cut -d&lt;span style="color:#e6db74">&amp;#39; &amp;#39;&lt;/span> -f1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.10.249.191
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="what-is-the-name-of-the-important-list-that-the-attacker-stole-from-santa">What is the name of the important list that the attacker stole from Santa?&lt;/h3>
&lt;ul>
&lt;li>By filtering the data using the GREP and cut commands, we can examine the user agent for each saved query. The log entry with the &lt;code>Wget/1.19.4 (Linux-gnu)&lt;/code> as a user agent caught my attention, mostly because its status code 200 indicates a successful http request.&lt;/li>
&lt;li>According to this analysis, the filename is: &lt;code>santaslist.txt&lt;/code>&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>elfmcblue@day-2-log-analysis:~$ echo &lt;span style="color:#e6db74">&amp;#34;Request_type url_path http_status_code user_agent&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;amp;&amp;amp;&lt;/span> grep &lt;span style="color:#e6db74">&amp;#34;santa&amp;#34;&lt;/span> webserver.log | cut -d&lt;span style="color:#e6db74">&amp;#39;&amp;#34;&amp;#39;&lt;/span> -f2,3,6 | sed &lt;span style="color:#e6db74">&amp;#39;s/&amp;#34;//g&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Request_type url_path http_status_code user_agent
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /santa HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /santa_claus HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /evilsanta HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /santana HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /santabarbara HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /santaslist.txt HTTP/1.1 &lt;span style="color:#ae81ff">200&lt;/span> &lt;span style="color:#ae81ff">133872&lt;/span> Wget/1.19.4 &lt;span style="color:#f92672">(&lt;/span>linux-gnu&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /santafe HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /jasonsantamar-20 HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /santa_maria_maggiore HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /santa-clara-county HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /texas-santa-barbara HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /topicsantafe HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /jasonsantamaria HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>GET /carlossantana_75 HTTP/1.1 &lt;span style="color:#ae81ff">404&lt;/span> &lt;span style="color:#ae81ff">437&lt;/span> gobuster/3.0.1
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="look-through-the-log-files-for-the-flag-the-format-of-the-flag-is-thm">Look through the log files for the flag. The format of the flag is: THM&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>elfmcblue@day-2-log-analysis:~$ grep &lt;span style="color:#e6db74">&amp;#34;^THM{&amp;#34;&lt;/span> SSHD.log webserver.log
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>SSHD.log:THM&lt;span style="color:#f92672">{&lt;/span>STOLENSANTASLIST&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ending">Ending:&lt;/h3>
&lt;p>I hope you enjoyed this walkthrough and you learned something new ;).&lt;/p></description></item></channel></rss>